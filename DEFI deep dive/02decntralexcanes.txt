# Uniswap
In the second module, we're going to be talking about decentralized exchange or DEX. Most of the discussion will be focused on the leading DEX, which today is Uniswap. What is Uniswap? We've actually been introduced to Uniswap in the previous course in terms of defy preeminence. I gave you an example of a constant product automated market maker. Uniswap is basically the prime example of the automated market maker on the Ethereum Blockchain. We will talk about version 2 of Uniswap. There is a version 3 that I will also talk about and the differences between version 3 and version 2. But I think it's important to understand version two before actually going to version 3. Again, the example that I used in the previous course used a constant product rule. In the previous course, we had a situation where we had 10 of one coin, 10 Ether, and 1,000 of another coin, let's say USDC. The key was to multiply those two together, and we got 10,000. That is something that will be fixed. The algorithm, so in this formula, the k is going to be fixed. I showed you examples of how this constant product, an automated market maker actually worked and we've got plenty more examples in this module. Again, the product is denoted as k. It's the lingo and DeepAI. This is called the invariant. It remains fixed. The AMM is risk neutral, and what I mean by that is that it is not aware or doesn't really care if you're buying or selling. This is a completely different than traditional finance, where there would be a market maker and that would be a person, and they would definitely care whether you're buying or selling and they'll be different prices. This is a very interesting idea, and it's a very simple idea, and literally just the tip of the iceberg in terms of what can happen in this space. Because we've got this constant product, k equals x times y, we also have the exchange rates that are set as basically just the ratio of the x and the y. Let's go through a number of examples and these are very simple examples, to give you the idea of what's happening. Let's think of a Uniswap pool where we've got two stable coins, DAI and USDC. As with any Uniswap pool, you put in the same value in terms of the pair. These are both linked to the US dollar. Four DAI equals four USDC. In this situation, the invariant or the product of the supply of DAI and USDC is 16. The exchange rate is just one to one.
Play video starting at :4:20 and follow transcript4:20
The invariant, you can see how that's calculated. This is where we start. Now this is an example of a pool of liquidity that is really sparse. This is just for an example, we'd never have a pool with so few DAI and USDC. It doesn't make any sense, but for the illustration, let's actually go through and look at the mechanics. Suppose that you wanted to sell four DAI for USDC. That's, we're going to use our DAIs. We've got somebody that wants to sell four DAI. We're going to use the automated market maker. We're going to deposit the four DAI to the contract, and it turns out that you can only withdraw two USDC.
Play video starting at :5:23 and follow transcript5:23
Again, look at the mechanism here. An additional four DAI had gone into the contract, so we've got a total of eight. We need to maintain the invariant. The invariant is 16. The only way to maintain the invariant is to have two USDC. Only two USDC are able to come out of the contract when you deposit the four DAI. This is essentially how this works in a very simple way, and you can see that that's a very considerable decrease in value. Notice that the effect of exchange rate here was two DAI for one USDC. Again, this is, we sometimes call a slippage, but this is really the result of insufficient liquidity in the pool. This is an example of something that really doesn't work. The mechanics work, but it doesn't make any sense that it would take two DAI to buy one USDC, certainly not on the open market. Now let's change the example a bit. Let's add some additional liquidity. Even this amount of liquidity is too small, but I want you to see how it transforms the situation. Now let's say we've got 100 DAI and 100 USDC. The invariant now is much larger. Previously we had 16, now we've got 10,000. Let's do the same transaction. Somebody wants to sell four DAI for USDC. Again, they deposit four DAI into the contract, and what they're able to pull out according to the algorithm is 3.85 USDC. You can see the mechanics in the box below, that if you look at the invariant, which is 10,000, we now have 104 DAI, and the only way that we can maintain the invariant is to have 96.15 of the USDC.
Play video starting at :8:14 and follow transcript8:14
That's where the 3.85 actually comes from. You can see that that's way different than the previous, that the slippage here is effectively going from four DAI to 40 USDC, the slippage goes from four to 3.85 USDC. It's a smaller amount, but still it's large. Why I don't have the example here, you can probably see where we're going here, that if it was the case that instead of just 100 DAI and like 100 USDC, that we have millions in this pool. The slippage is going to be really, really small. This is really important here, that liquidity is crucial. If there's deep liquidity, it's going to minimize the slippage. The slippage is the amount that the exchange rate will actually be changed by the actual trade that you're executing. It's important to have these for the success of a decentralized exchange like Uniswap, to have sufficient liquidity. In the big picture here, decentralized exchange is a competitor to the centralized exchanges like Coinbase and Binance and Kraken. For the decentralized exchange to give the user a good experience, it's important to minimize that slippage or to maximize liquidity in the pool. Indeed what Uniswap does is, incentivizes depositors to supply the capital. You provide capital, you're incented, there's lots of capital. There's minimum slippage and the decks becomes much more competitive or even superior to the centralized exchange. Then notice that the liquidity provider is adding to both sides of the market, when you set this up, you put an equal amount of liquidity at both sides.
Play video starting at :10:58 and follow transcript10:58
There's a number of different layers in terms of the importance of liquidity,
Play video starting at :11:8 and follow transcript11:08
basically when additional supply comes in, this will increase the liquidity and decrease the slippage. The higher the invariant is, then the lower the slippage. You can see, you can indeed graph it out to show the amount of slippage as a function of the invariant. The invariant, you can think of it differently, is a direct measure of liquidity and this particular protocol.
Play video starting at :11:52 and follow transcript11:52
Within Uniswap there are some fees, there's a 0.3 percent fee and that fee is paid back into the pool. This is a fee that those that are providing the liquidity, providing the supply, they're going to earn the fees based upon their contribution to the liquidity pool. You can imagine what's happening here, there can be lots of trading on both sides, buying and selling, and the more activity the more fees that are being generated, and the more that goes to the suppliers of the liquidity.
Play video starting at :12:42 and follow transcript12:42
Ideally, if you're supplying liquidity, you would like to actually go to a pool that's got a lot of volume, a lot of turnover. This mechanism is very similar in terms of what Uniswap does to the cToken that we discussed with compound, you're providing liquidity that needs to be a share of the pool and to see, we've got Uniswap own version of this. Think of a DAI, Ethereum pool as having a Uni token that is DAI/ETH. It's a little different, but the same basic idea, in terms of the Uni token.

# Impermanent loss
We've introduced the idea of impermanent loss before and let's actually go through it again in the context of Uniswap. Again, the idea here is liquidity providers. They supply the capital. Because of the nature of this constant product automated market maker, there will be some impermanent loss as the exchange rate actually changes. We went through some calculations before as to how this works.
Play video starting at ::40 and follow transcript0:40
Even though the liquidity providers are earning, a rate of return based upon the volume of trading within the pool. There's also a cost associated with this in terms of the impermanent loss. Let's go through that again we went through it quickly in the previous course. The impermanent loss is an opportunity cost. It is the amount of money that the liquidity provider would have made if they didn't pledge liquidity to the liquidity pool but just sat on it. So it's an opportunity lost. It will happen anytime there's a deviation from the initial market price, ratio for the two, and the only way that there's no impermanent loss is if that ratio stays the same. That's essentially important for impermanent loss. Again, the fees hopefully will overcome the impermanent loss but nevertheless, this is one of the downsides of any constant product automated market maker. One way to reduce impermanent loss is to look at pairs that are highly correlated. When the pairs are highly correlated are mean reverting, then there's going to be not that much deviation and exchange rate and the impermanent loss is going to be very small. The examples that I used in the previous course were dramatic examples where something went up by 400 percent and something else went up by 200 percent. It's a huge gap between the performance. Literally, one of the pairs doubled relative to another pair. If you think of a low volatility or high correlation pair, like DAI and USDC, that's just not going to happen. The impermanent loss is very low for a very highly correlated pair.
Play video starting at :3:13 and follow transcript3:13
Impermanent loss is something that is well-known in the space, so people providing liquidity understand impermanent loss. They understand that they need to take that into account in factoring and what the expected rate of return is. They also understand that high correlation pairs, minimize that and there's some protocols that just focus on high correlation pairs. But the problem is that people want to trade cryptos well beyond the high correlation pairs. There's only so much you can do with USDC and DAI. This impermanent loss is just something that we have to deal with.
Play video starting at :4:5 and follow transcript4:05
Essentially, almost any ERC-20 pair is possible on Uniswap. This is super interesting that anybody can start a pair, so ERC-20 to ERC-20. You've got a new token that you're introduced, well, you can seed it in a Uniswap pair. It's instantly available for trade. Think about that in traditional finance. How difficult it is to actually get a stock listing. Only a very small number of companies can actually do this, and they have to go through a very costly process to actually be traded. Well, with Uniswap, it's immediate. You can actually just create a liquidity pool and it might be that you've got a new token, you create many of these pools, and it's available for trading in terms of this decentralized exchange.
Play video starting at :5:16 and follow transcript5:16
One thing that's interesting is that this is designed for all ERC-20 tokens and Ethereum is not an ERC-20 token.
Play video starting at :5:35 and follow transcript5:35
These tokens are based upon the Ethereum Blockchain, but Ethereum isn't an ERC-20. Is that a problem? No. Because there are wrapped versions of Ethereum, so w-ETH. We'll talk about wrap versions a little later on, but it's just a way to tokenize Ethereum. There's a wrap version of Bitcoin also that operates as an ERC-20 within the Ethereum Blockchain. Indeed, that is the one we'll talk about a little later.
Play video starting at :6:21 and follow transcript6:21
Within Uniswap, the way it works is that if you've got the Ether, you can actually use it, but it's immediately translated into the wrapped version of ETH, which is the ERC-20 tokens. Router contracts, that's one of the words on the word cloud that we'll reveal at the end of this course. How is this useful? Well, it might be that you want to trade a pair that isn't available on Uniswap. You want to do AB, but AB isn't available, but there is an AC and there's a BC, so effectively what you can do is to triangulate and find the best route through the different pools to get the exchange that you actually want and this is done with a router contract. Even if the pair isn't offered, that doesn't mean you can't trade it within this decentralized exchange, you just need to employ a router contract that can do this very efficiently. We talked a little bit about front running previously and I want to go back to that. This is an issue with automated market-makers, it is an issue with proof of work in general, in that the miners can see all of the pending transactions. It could be that there's a pending transaction that takes advantage of an arbitrage opportunity, maybe it involves a flash loan. Well, the miner can literally just copy that transaction and put that into the candidate block that they're mining and effectively front run. Again, I want to emphasize that this type of front running is not to be confused with the illegal front running in traditional finance. This is not illegal because all of the information is publicly available. This is public and the miners are willing to do this, but they want to do this because this is a way to increase their revenue. Again, this is a downside proof of work that will likely be mitigated in the future when we actually go to a proof of stake type of model. I also want to emphasize that it's not a sure thing, that the miner might front run, but the miner might not win the block and if they don't win the block there's no front running. The problem exists when many miners are doing the same thing, they see the same opportunities. Again, the memory pool of all the candidate transactions is open for anybody to see, is very straightforward, you need a browser you're in and you can see all of this. This is their game within this particular system. Uniswap also offers something interesting, which is maximum slippage. Essentially within the transaction, you can say that if the rate slips to anything below x, then don't execute the transaction.
Play video starting at :10:22 and follow transcript10:22
This is easily done and essentially it is a check in the contract and if the condition where the slippage is above the maximum, then the transaction remember is atomic and it doesn't actually do the trade, so we revert to where we were. That's a nice idea within this idea where you can specify a level of slippage that you're comfortable with and it provides a degree of risk management that's important. There's lots of possibilities here for arbitrageurs because there's so many of these pools that are available, that you can imagine I told you about a router contract that if you've got a pair that isn't traded, you can find other pairs to triangulate and effectively trade. Instead of just running on one liquidity pool, you have to do multiple. Well, there's also this possibility of seeking out arbitrage possibilities given the network of all of these exchange rates. This is maybe a drawback, but maybe not because the arbitrageurs are making sure that the prices are what they should be, and they shouldn't deviate, there shouldn't be any arbitrage, and just the act of arbitrage is actually making those prices more fair. But nevertheless, this is something that essentially the arbitrageurs are profiting at the expense of the liquidity providers and ideally you want the prices set in a way that minimizes this possibility. Of course, a lot of liquidity is very helpful, but there could be some pools that are illiquid that cause issues and an arbitrage obtains.

# Flas swaps
Next we're going to talk about a flash swap. We've talked about flash loans. What is a flash swap? Basically flash swap is a contract sends tokens before the user actually pays for them.
Play video starting at ::28 and follow transcript0:28
A swap is just an exchange, but this is a little different than a flash loan. There's a lot of possibilities and terms of deploying this idea where you can essentially deploying liquidity to acquire another asset and get this basically before paying for it. Again, this is going to have zero duration, it's all going to be within one transaction, but it opens up many possibilities here. It's swap because we're going to be operating with not just one asset. The swap is an exchange of one asset for another. A loan is always the same asset. Let's go through the details and mechanics of a flash swap. Again, this is much different than the flash loan because a loan needs to be repaid in the same asset. I borrow 10,000 DAI, I need to pay back 10,000 DAI. The swap will be with different assets. Again, it's in a single Ethereum transaction. It's going to be atomic just like the flash loan, but it's a very interesting idea that happens on Uniswap. Let's as usual go through an example. Let's say we're talking about the DAI/USDC market that we've talked about before. It's a high correlation market, not that much impermanent loss. We've got a supply of a 100,000 each. This is a large K, so the invariant is quite large here. Having a 100,000 each means that the exchange rate is one to one and the invariant is 10 billion. A 100,000 times a 100,000. In this situation we've got a trader that has no starting capital, that's important. It's like a flash loan. Remember that the flash loan, there was no collateral for it. For this flash swap, the same thing, just no starting capital. But they see that there's an arbitrage opportunity to buy DAI on another DEX for 0.95 USDC.
Play video starting at :3:18 and follow transcript3:18
You see the possibility here, if I can buy for 0.95 USDC, and then sell for one on this very liquid Uniswap market with the invariant of 10 billion, then this is an arbitrage opportunity. Let's go through the details of how this works. It's going to involve the flash swap. What we're going to do, and I've got the diagram that explains this, that we're going to withdraw 950 USDC, a flash liquidity.
Play video starting at :4:7 and follow transcript4:07
Indeed this is derived from a flash loan. We're going to do this from the DAI/USDC market and then purchase 1000 DAI via the arbitrage trade. Then we're going to repay 963 DAI and end up with a profit. The 963 is going to be calculated as the 960, and I've got rounding of course. We need to maintain obviously in the invariant of 10 billion and there is some slippage as a result of that.
Play video starting at :4:55 and follow transcript4:55
This is not without slippage. Let's actually go through the mechanics again. There will be 30 basis point fee that's going to be paid into the pool and let's see how it actually goes. So from Uniswap, step number one, we'll flash swap 950 USDC, and then we're actually going to trade with that USDC. We're going to trade with this alternative DEX. Notice the alternative DEX, the exchange rate is 0.95 USDC for one DAI. 950 USDC is going to get me 1,000 DAI. I've got the 1,000 DAI I get from the DEX in step number 2. Then I close the flash swap with 963 DAI. The slippage here is 10 DAI. There's a fee of three DAI, and this means that the swap is done at 963. Think about the profit here, the profit is 1,000 minus 963, which is 37 DAI. This is all done in one transaction and it is arbitrage because you make some money for not taking a lot of risk. Again, this is atomic at any point if something fails, then we return to the original state.

# Okay, what about the governance, being a swap and I previously mentioned that we were talking about version two, what is version three? So let me talk about that, so Uniswaps basically has a governance token called UNI, and that was launched in September 2020. So the governance token very similar to COMP and that it is actually distributed to users to incentivize liquidity. So this is something that you get for actually supplying liquidity. So think of this, we've already talked about that the liquidity providers are making revenue from the trading that actually occurs with that 0.3% fee. They might be losing in terms of impermanent loss, but they are also gaining because they're being incentivized with the UNI token.
Play video starting at :1:11 and follow transcript1:11
Okay, so this is interesting that the UNI governance has some control over its own token distribution. Okay, so 43% of the supply is going to be vested over four years and there's a treasury that's controlled by the UNI governance. Okay, so it's interesting that every Ethereum address that had used Uniswap before the cut off date, and this was like a quarter of a million addresses, was given approximately 400 of these any tokens, so again, an airdrop.
Play video starting at :1:57 and follow transcript1:57
So again, this is a really interesting idea that's really important in decentralized finance, that the early users are being rewarded with effectively something like equity and at least the governance. So you've actually participated, and now we want you part of the community to determine the sort of things that are important in terms of the protocol and it's also a direct incentive mechanism to get people actually involved. So UNI was released, is traded also on centralized exchanges like coin base, and indeed you can see a the governance token for Uniswap here is incredibly valuable.
Play video starting at :2:54 and follow transcript2:54
So think of that 400 UNI given the current market price, that's quite a reward for participating early. And it's also the case that the AAVE and the Maker Token also are quite valuable. So if you look at the list of the top 25 Cryptos by market capitalization, you're going to see a number of governance tokens. So what about version 3? And version three is very recent, this was implemented on May 5, 2021. And let me tell you the key idea in version three, and the key idea is that the liquidity providers can allocate funds to their own customized range.
Play video starting at :3:58 and follow transcript3:58
Okay, so instead of having the full range when you allocate liquidity, you can actually narrow it.
Play video starting at :4:7 and follow transcript4:07
So effectively you've got these individualized price curves.
Play video starting at :4:13 and follow transcript4:13
So this is a great idea, and it's a great idea because it's very similar in traditional finance to this idea of a limit order system. Now, for the user, everything is all grouped together, so the user doesn't see this, but for the supplier of the capital, you can choose a range that is something that you're comfortable with.
Play video starting at :4:49 and follow transcript4:49
So again very much like a limit order book. So very good idea, as of this production, it's still the case that the most of the pairs are version two, but the volume on version three is already exceeded of version two, so this is just the next stage and the evolution of decks. So let me summarize, this is a critical component of the DeFi ecosystem, so the ability to trade algorithmically at any time.
Play video starting at :5:33 and follow transcript5:33
So it doesn't matter when you do this, the ability to basically supply liquidity and get paid for it in terms of the trading fees that you get plus the incentives from the governance token. And this idea of a flash swap, which is a very significant innovation. So this is something that allows essentially anybody to do arbitrage. So again think of this and look arbitrage is well known, who does arbitrage, like hedge funds?
Play video starting at :6:16 and follow transcript6:16
So it's just not usually available to the average person. But this is again the democracy of decentralized finance, that if you don't have any capital, no big deal, you can make that arbitrage profit. And in doing that, in doing this arbitrage, the prices move towards like a fairer price, which is good for everybody. So again, let's see what, Uniswap actually does in terms of the problems perhaps the most striking thing, at least for me, is that, that anybody can start a trading pair, that's to me just really amazing. So you've got a new token, well, no problem, you can use Uniswap, and you can see the liquidity pool, and you can do it very quickly.
Play video starting at :7:25 and follow transcript7:25
Okay, so this is so different than centralized finance. Of course, anybody can be a liquidity provider and earn the fees and the incentives. The automated market maker, or decks, is a very significant innovation in the idea of exchange, you get rid of the human market maker, you get rid of all of the infrastructure associated with that, you get rid of the spread, get rid of the risk, so this is a very powerful idea. And this is pluggable into any application within the Ethereum landscape. Again, and I showed you an example of using an alternative decks, and in a single transaction, taking advantage of a price deviation. And of course, and it's becoming a little redundant, everything is transparent, so for the pool, you know exactly what's in it at any point in time

#Balancer
So with the in a swab you've got a pair and when you supply, you supply the same amount in terms of dollar amount for both sides. So that's kind of how we went through, you know swap. And it's a very simple formula in version two where we've got X x Y = K. In K C and variant. So X is the number of tokens for assad x and y is the number of tokens for assad Y. So, it's no surprise that given that this is a very basic sort of system that somebody would come up with an idea to generalize. And that's what balancer actually does. So balancer is decentralized exchange. Its automated market maker just like a you know swap. And basically what this protocol is able to do is to do more than two assets in a liquidity pool. And at the time of production It was eight assets. So and these can be ERC at 20 tokens or ethereum, okay? So, this is an innovation that generalizes to this initial structure by you know swap. So how does it actually work? And let me show you. So the formula is is basically defines a bonding surface. So the formula that I showed you for, you know swap is a simple bonding curve. This is a this is a bonding surface. And the idea if you can see that formula is that the Bs represent the Balance of the tokens and there can be more than two tokens. But if there were only two tokens it would just be token X and token Y. Basically X x Y. That operator that says V equals that's a product operator. So you multiply thanks. So in the simple example of a, uni swap you would have X x Y = K. In this situation we've got an exponent that represents the weight of the token. So if there was equal weight then it would just be X x Y = K. But the exponent allows for differential weights in terms of the assets that are contributed to the liquidity pool. So again you've got the in variant but the in variant is a more complex function. So the surface that I'm showing you here is for three assets in a pool rather than tool. But we can't do this diagram for eight. But you see the idea. So the idea basically is instead of X x Y, we can have X x Y x Z. And then we kind of differential sizes of supply and that's going to be determined by exponents on X and Y and C. So this generalizes the formula in uni swap and it allows for a pool to have multiple assets with different sizes. So this is basically a mechanism to get exchange rates but I can figure out the pool value. This all obtains with this fairly simple mathematical formula that is just a little more general. There are some issues here. There are some limits in terms of the amount that you can swap and a balance or a pool and what you can put in, what you can put out. There are some limits that actually doing this. And there are transaction fees and the liquidity pool controllers. So those that kind of see that can can set the fees so the fees might be really, really cheap or they could be pretty expensive. So this is part of that protocol also. And it's also the case that in permanent loss is an issue. And the it's interesting in the balance or paper that I've got referenced at the bottom. They look at different weightings and determine how these weights contribute to the impermanent loss. So, this is overall like a good idea. Of course there are there slippage as we would have with any automated market maker. We've got the order routers, like we've got with uni swap all of this is part of this really growing kind of interest and decentralized exchange and making it as efficient as possible. So not surprisingly, balancer also has a governance token the BAL. And there's a limit to that token. And I've actually detailed where the token is allocated, so the founders getting one quarter of the balance. But a substantial amount, 65% is allocated to liquidity holders. So this is also an incentive mechanism. So like all of these D five protocols, you've got disability to incent people to use the protocol and balance, or does that with the BAL token.

# Rehypothecation
Let's finish up this second module and I want to talk about something that we've talked about indirectly but I want to be much more specific and this is the idea of rehypothecation. This is a concept that is very well known in traditional finance, but it's important to understand in the context of decentralized finance and it can help but use an example. We've talked about having collateral and if you're borrowing, you need to have collateral and we've gone through examples of what happens if you go below your lateralization ratio, the keepers will come in and close you out. I want to contrast that with the high profile situation that happened in 2021, with the large family's authors that essentially they went under because they were under collateralized and there was no automatic mechanism. Let me start this with a quote from a description of Archegos situation. It is remarkable because it really shows the difference between centralized finance and decentralized finance so I'm actually going to read this and this is from Matt Levine. ''Once you know the right amount of collateral, and you call up the hedge fund to tell it to post more collateral, and then the hedge fund says, ''I'm busy today, let's talk tomorrow", and then you call them tomorrow and they say, ''Hey, this week got away from me, but send me an email", and you send them an email summarizing your collateral demand and call them next week and they say ''Oh, I haven't had a chance to look at your email yet, but I will very soon'', and meanwhile, the right amount of collateral keeps ticking up. What do you do about that? There is a theoretical and contractual answer, which is if the client doesn't post the collateral you want, then you terminate the swamp, but you are the person and the hedge fund does sound really busy, and surely it can't hurt to talk to them tomorrow? Plus if you terminate the swap you lose their business, and your whole job is about doing more business." This is a powerful situation where investment banks lost billions of dollars in this particular blow-up. It was clear what the collateral needed to be. It was clear that the hedge fund or family office was underwater, but there was no mechanism, was it email, phone call delay, delay, delay so that's much different than decentralized finance. Let's talk about rehypothecation and what does that actually mean? Hypothecation is simply pledging collateral, so just a fancy word for pledging collateral, for debt so you might pledge your house for mortgage debt. That's an example, or a factory might pledge their plant for some debt from the bank. Rehypothecation is when the collateral that you post to the bank or the brokerage is actually re-used by the bank.
Play video starting at :4:1 and follow transcript4:01
This idea of reusing collateral is called alone history and sometimes this is called re-pledging. Sometimes it's called re-use of collateral and within centralized funds, there are specific rules that you need to follow regarding this re-use of collateral, in particular, the Fed Regulation T. Of course, in the space of decentralized finance, there are no rules. There's no centralized authority that's regulating anything and decentralized finance and you might think, "Oh, well, they're regulated exchanges in the US like Coinbase or the US branch of finance." Well, that's true but remember, they are centralized. They deal in decentralized finance, but they are centralized. What I'm talking about is the theme of this learning experience, which is decentralized finance. The equivalent are the decentralized exchanges. There are some issues that we'll talk about a little later in terms of risk. But there is no regulation like this everything is algorithmic. I want to talk a bit about a concept in decentralized finance called Total Locked Value. One way to think about that is you put money into a liquidity pool, and that is the value that has been pledged into the system. Equivalent and banking might be the amount of deposits that a bank actually has. We've talked about this in terms of MakerDao, Compound, Aave, Uniswap, and other protocols that we've dealt with. They call it Lock Value, but it's really misleading to call it lock value because they're not really locked. If you want to withdraw, you can withdraw at any point. There's no barrier to actually doing that. Indeed, it's much more difficult to do it in, in centralized finance. We need to be careful in terms of how we count that Lock Value.
Play video starting at :6:39 and follow transcript6:39
Essentially what I'll talk about is that if there is this rehypothecation, then you might be counting the collateral multiple times. What do I mean by that? I think the best way to get the intuition as to what this means, is to go back to centralize finance and talk about something called the money multiplier, which maybe you were introduced to in an Introductory Macroeconomics course. Somebody deposits a $100 at a bank. The bank, according to the Federal Reserve regulations, has to have a reserve at the Fed, of let's say 10 percent. 10 of those dollars is parked at the Fed. But then, the bank can take the other 90 and lend it out. Let's think about that. Somebody borrows 90 from the bank, and then they take that, and deposit it at another bank. The second bank has to go through the same process. They've got $90 deposited. The regulations say that 10 percent needs to sit at the Fed. That means that they're able to lend out 81 and this process just continues to go and you can see that that initial deposit, of a $100 actually generates a lot of lending. Indeed, at the limit, it actually creates $1000. You just take the initial amount and divide by the reserve requirement which is point one zero. This is the idea of a money multiplier that an initial deposit can actually multiply itself a throughout the system. The same idea applies to decentralized finance. Let's go through an example of how this might happen. I put some numbers to this example so you can appreciate the actual mechanics. Let's say in this case, a user deposits $1500 of wrapped WETH into Maker, which we've talked about, and gets a loan of 1000 DAIs, which is the equivalent of a $1000. This implies a collateralization ratio of a 150 percent, which is about in the ballpark of what we actually dealt with when we're talking about a MakerDao. You've got the 1000 DAI, and the user then deposits that 1000 DAI along with, 100 USDC into a Uniswap, DAI-USDC pool. Think about what the user has done here. The user has deposited $1,500 and $1,000 of USDC, so the total investment of the user is 2,500, and it's a combination of wrapped, ETH, and USDC. Then, Uniswap issues their liquidity token that represents $2,000, so the user could actually redeposit, underline the re because this is the whole idea of what I'm talking about here. The user could redeposit the liquidity tokens into Maker and get another loan of 1,960 DAI. Notice, that when you're depositing the liquidity tokens, given that they're based upon a stable coin pool of DAI and USDC, the collateralization ratio's really low, it's a 102 percent. Let's actually go through to see what's happening here. To calculate the total lock value, we've got $1,500 of wrapped ETH. We've got a $1000 of liquidity added in USDC, we've got liquidity added to a Uniswap of 1,000 DAI, and then we've got the liquidity tokens that are worth 2,000. If you add all this up, it comes to $5,500. But notice that the amount pledged is only 2,500. Think of this as the first round of the money multiplier that I described in centralized finance. This could continue to go on in terms of re-pledging the collateral and we would come to much more than $5,500 worth of collateral. The formula for the maximum amount is not as simple as in centralized finance. On centralized finance, it's really straightforward. You take the deposit divide by the required reserve, 0.1 in my example. But notice in the example that we just went through, there were two collateralization ratios. In the risky pool, it was a 150 percent. In the pool that had two stable coins, the ratio was only 102 percent. The formula is not as simple as it is for a bank, but the same idea obtains. This is how it's possible that indeed the number of DAI in the system could be more than the number of DAI actually issued. The same way that the number of dollars in the system might be more than the number of dollars printed by the Central Bank. This is an important concept of reusing a collateral and is very common in decentralized finance. Indeed, it's very important in terms of how the system actually works. I do want to emphasize that this is all algorithmic. You've got a collateralization ratio.
Play video starting at :13:42 and follow transcript13:42
We're talking about a point in time that is approximately 18 seconds. If you pierce the bound in terms of the collateralization ratio, then you're going to be closed out by a keeper, and the keepers are incented to actually do that. There's no, as I said at the beginning, email or telephone call or a appointment next week. This is done rapidly and efficiently. In doing that, it preserves the confidence of the system, and that's really important in terms of people using it in the future.