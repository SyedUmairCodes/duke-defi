# Intro
Welcome to the third course in the learning experience, DeFi in the future of finance. In this course, we're going to take a deep dive into the most popular protocols that are available today and will be available in the DeFi space. This is the third course. Actually I recommend that you do the first two before this course. This course is going to seem very confusing because we've already gone through and established the basic infrastructure of DeFi. We spent a lot of time on the primitives that are fundamental to DeFi. Now we're going to put it all together and talk about the particular protocols that are the leading forces in the DeFi space. Let's get to it. What I will do, we've got four modules today; credit and lending. I will talk about three protocols that are important. MakerDAO, compound, and Aave. Then the second module is decentralized finance, the third is derivatives, and then the fourth is tokenization. Let's start with MakerDAO, which is pioneering DeFi application. Let's start with the creation of DAI. MakerDAO, and we've actually already gone through the definition of what a DAO is. DAO is decentralized autonomous organization. It's no surprise that MakerDAO is a decentralized autonomous organization. The key in terms of the value-add here is to introduce a crypto- collateralized stablecoin. We've talked about stablecoins before. Remember, the stablecoin is only as stable as what it's pegged to. If you're pegged to gold, that stablecoin is going to be more volatile than, let's say, pegged to the US dollar. A stablecoin, there's various different ways to do it that we've discussed. One is to collateralize with, let's say fiat currency, like the US dollar. That is the model of USDC, which is a ERC-20 token. But it's centralized because there's an organization that basically manages the collateral, and provides vaulting, and audit all functions. It is a centralized stablecoin. DAI was one of the first decentralized stablecoins. One big advantage of a decentralized stablecoin that uses crypto is that the crypto-collateral, you don't need to vault, you don't need to audit. It is available to view by anybody in the network. You can exactly see the collateralization in real-time. Because there's a lot of advantages to actually using a crypto, but there are some disadvantages too. That is that the crypto is going to be volatile that's used for collateral. For example, Ethereum is much more volatile than for example, the US dollar. This is a protocol model that has two tokens. DAI is the stablecoin, and Maker MKR will be the governance token. I'm going to talk about both of these. That's the background. Let's talk about the mechanics of DAI. This is essentially the way that it happens. A user can deposit some ETH, and it doesn't have to be ETH, it can be another ERC-20 token that is approved in the governance of the protocol. Deposit it into a vault, which is just a smart contract. That vault will escrow the collateral. It will basically, in doing that escrow, anybody can see it and anybody can figure out what the value of that escrow is. When the user actually does this, they can mint some DAI up to a certain collateralization ratio. This creates debt. The debt is in DAI and that debt needs to be paid back to the vault. That's the basic model of what's going to happen. You deposit some ether and then there'll be some lateralization ratio that we'll go through in considerable detail, and there'll be some debt that is denominated in DAI. The user can take that DAI, and basically do whatever they want with that. You could sell the DAI for cash and use that cash to buy whatever you want to buy, say a car. But there's also another possibility that's interesting. You can take the DAI and buy some more Ether and then do this process again. When you do that, you create a leveraged, position in Ether. Effectively you're borrowing to buy more Ether.
Play video starting at :6:55 and follow transcript6:55
Ether, of course, is much more volatile than, let's say US dollar. The collateralization needs to be more than a 100 percent. If it's a 100 percent, it easily could drop below a 100 percent, and then that will affect the value of DAI. What we want to do is to keep DAI as close as possible to the value of the US dollar. A typical collateralization ratio, if we're using a volatile crypto, like Ether, would be 150-200 percent range.
Play video starting at :7:43 and follow transcript7:43
The whole setup here if you're familiar with centralized finance, is actually nothing new except we're doing it within the DeFi space. This is just a collateralized debt position or CDP. It's analogous to a mortgage. Think of the homeowner. The homeowner needs some cash for whatever purpose. One thing they could do would be just to sell their house and take the cash, then use that cash for whatever purpose. But maybe they don't need that much cash number 1. Number 2, maybe they don't want to sell their house because they believe the house is going to appreciate in value. What do you do? You go to a centralized bank, commercial bank and get a mortgage.
Play video starting at :8:45 and follow transcript8:45
To get the cash and the mortgage, you need to pledge as collateral your house. The house is worth more than the mortgage. It is over-collateralized.
Play video starting at :9:3 and follow transcript9:03
The price of Ether is way more volatile than a price of a house. It makes sense that the collateralization ratios for Ether need to be much higher than, let's say, a typical mortgage. There's obviously other differences. This happens algorithmically. There's no overhead, no back-office, no credit check, no lawyers, no brick and mortar. This is extremely efficient in terms of how this is actually executed and is executed quickly. I recently refinanced my home mortgage and it was a nightmare in terms of the number of steps, the cost. All of these things that were in my opinion, unnecessary, had to happen and it took weeks to get done. This happens very quickly. Within a few minutes. This is just a collateralized debt position.
Play video starting at :10:21 and follow transcript10:21
In this course, we've got lots of examples and I think the best way to really understand what's going on is with examples. I've got many and let's start. You've got an owner of ETH and they need some liquidity. But they don't want to sell the ETH because for the same reason as the homeowner, they actually believe it's going to appreciate in value. We're going to use the maker DAO structure and essentially, deposits some ETH and withdraw some DAO, which is analogous to cash. Very straightforward, and let's go through and actually do that. Suppose an investor has five ETH and the market price is 200. That means the total amount of value in the five ETH is a $1000. If the collateralization ratio is 150 percent then the investor can mint. After depositing the 5 ETH, they can mint 667 DAI. That's just calculated as 1,000 divided by the collateralization ration ratio which is 1.5 and throughout this course, there'll be rounding. I won't use the decimal places. Again, this ratio is set fairly high because we know that the value of ETH is much more volatile than the value of DAI, which is linked to the US dollar.
Play video starting at :12:22 and follow transcript12:22
It doesn't really make any sense. If you were allowed, for example, to mint $1,000 worth of DAI because just a daily fluctuation in the price of ETH would mean that the loan would be under collateralized. This again would damage the stability of the DAI. The peg is credible only if you've got the reserves. That's true in centralized finance too. If a country has pegged their currency to another currency, that peg is only credible if they've got the reserves and if they run out of reserves then the peg is broken. We've got plenty of situations historically where that happened. That's the basic background. Let's continue this example. We've got collateralization of 1.5. It's going to be unwise to mint the maximum, which is 667. Because again, if you fall below, then you are under collateralized and subject to liquidation, which we'll go through in considerable detail. When you go and become under collateralized, in traditional finance, your broker calls you and you get a so-called margin call. You're asked to post more collateral. The DeFi space, there's nothing like that. If you go and become under collateralized then a position's going to be closed out. It's up to you to actually watch to make sure that you are not liquidated. Therefore, we're not going to mint 667, we're going to mint less. Let's actually go through an example here. In this graphic, we review that we've got 5 ETH and we deposit those into the vault, which is just a smart contract. What we're going to do is not mInt 667, but we're going to mint 500. This is a situation where we've got a buffer. There is the over-collateralization which is 333 and we've got this buffer of 167 and we will mint 500. You can see that this works out, so the loan is 500 based upon the deposit of 5 ETH. Let's look at a couple of scenarios and the first scenario is that the ETHER appreciates and it goes up by 50 percent. In this situation, we go from $200 per ether to 300. Let's go through the mechanics. Now the collateral will be worth not $1,000 but $1,500. With this collateralization ratio of 1.5, we can actually increase the value of our loan. Originally we took out 500, and that means we minted 500 DAI. But given that the collateral is increased in value, we can basically do an additional loan of 250 so the total amount loan would be 750 based upon this new value and that would maintain the collateralization. We'll be done our collateralization ratio that we've actually imposed for ourselves is not 1.5, but two and this is to allow some buffer, if it does drop, we won't be immediately liquidated. Now let's talk about liquidation.

# Liquidation
Now let's talk about a different situation, a liquidation situation. We've just been through an example where the Ether actually appreciated, went up in value. Now let's look at a different scenario. In this scenario, Ether depreciates by 25 percent. That means that the Ether goes from $200 to 150. Let's go through the mechanics of what would happen at 150 value. Now we've minted 500, and the total value of what we've got here is only 750. The over-collateralization is 250 and that's rate at the edge, that is exactly a collateralization ratio of 1.5. Very dangerous to be at that point because just like a one percent or even less, further depreciation in ETH means that the contract is going to be closed out. This is a scenario where some action might need to be taken. Let's assume again that the ETH drops 25 percent from 200 to 150. Vault holder, it's got a number of possible options. The first option, which is analogous to what we would do with a margin call is just to add some more collateral. You could add, let's say 1 ETH to the vault, and then you'd be fine to be above the 1.5. The second option is you've got the 500 DAI, you could just pay back the loan and retrieve the 5 ETH that you put in originally. The third option is that the loan could be liquidated by a keeper. As soon as you go just a little bit below that 1.5 collateralization ratio, that's going to happen and it's going to happen very quickly and that is the job of the keeper that we spent a lot of time talking about in the second course DeFi primitives. The keeper is an external actor that's incented to actually do a liquidation. Let's actually go through a liquidation at the 1.5 or think about it as 1.49. But let's just go through what a liquidation would actually look like. The mechanics are the following: the keeper is actually going into the vault to liquidate 3.33 ETH. Essentially what's happening here is that those ETH are auctioned off and that will generate enough money to pay off the loan of 500. That's the first thing that the keeper does. The keeper also gets a fee for actually doing that. The keeper is incented to do this action, to do the liquidation, to keep the protocol strong and efficient, so the keeper is going to keep a 0.2. What about the vault holder? The vault holder ends up with 1.47 ETH, that's what's left over after paying off the loan and then the fee for the keeper. They get 1.47 ETH which is worth $220 and of course, they've got the original 500 DAI. Overall, what they get is 720. Let's think about that, is interesting. They've got 720, if they didn't go through any of this, if they just had their 5 ETH, or if they decided to pay back the loan and pull out the 5 ETH then the 5 ETH would be worth 750. This is a situation where the loan is over-collateralized. The loan is paid back, and any residual minus the fee to the keeper goes back to the person that made the original deposit of the 5 ETH. This is how a liquidation actually works. There's another layer that's very interesting here in terms of the stabilization of DAI. Why would a DAI be worth a dollar? Well, the most obvious reason is that it is over-collateralized. People believe is worth a dollar because it's more than a dollar in collateral. We know the collateral is risky. We know it's over-collateralized. Anybody can see the degree of over-collateralization. Again, on the Ethereum block-chain , everything is transparent. The other thing that's interesting is there's another stability force that's linked to market actions. In the liquidation, what actually happens here? The keeper goes in, and you remembered they sell 3.33 ETH. You're selling ETH in the market, and DAI are purchased. This actually exerts a positive price pressure on DAI. You can think of the overall scenario here is that the value of the collateral is going down, and people might think, well, maybe if it goes down enough, we're not going to have as much confidence that DAI is worth a dollar. As that collateral gets lower and lower, people will start to discount the DAI. Maybe it's 99, maybe it's 0.98. But with this liquidation, given that you're selling ETH and buying DAI, that actually acts as a counterbalance. There are two levels that actually build in for the stability. A very interesting mechanism. Of course, the key idea here is to maintain the peg. A stable coin, you want to be as stable as possible with respect to the peg DAI set. Ideally, you'd like it at exactly $1 all the time. There will be some fluctuations, 0.995, 1.01. But ideally, you want to maintain that one-to-one peg. Again, various different mechanisms here that are in play in this protocol, and we're going to talk about a number of them here. One is a DAI savings rate. We got a debt ceiling. We got a stability fee. These are parameters that are controlled in the smart contract by the governance of MakerDAO. The governance is the Maker token, MKR. It is in the governance's best interest to keep the DAI as close as possible to the US dollar. The stability fee is basically a variable interest rate that's paid in DAI by vault holders on any debt that they generate. This is, think of it as, an interest rate. This interest rate can be raised or lowered. This will basically incentivize, for example, the repayment of the DAI. If the rate goes up, then you're going to repay. This will basically drive the price towards the peg.
Play video starting at :9:30 and follow transcript9:30
The stability fees, fund the DAI savings rate, and this is a variable rate that any DAI holder can earn on their DAI deposit. If you've got DAI, you can actually deposit and earn this variable rate. This DAI savings rate is compounded on a per-block basis. Would just be interesting also because the block happens every, let's say 18 seconds. It's near-continuous compounding. The stability fee is always greater or equal to the savings rate and that is enforced by the smart contract. That is also very important and we'll talk about this later with some other protocols that this makes a lot of sense that the savings rate has to be less than the revenue coming in to actually fund it. There's also a DAI debt ceiling. This is again contract enforced. It is a parameter that's agreed upon that could actually vary through time. Just let me emphasize this. The fundamental nature of the contract, it is set in stone but there are certain parameters that can be buried by the governance and that's what we're talking about right now. This is basically the amount of debt has got a ceiling. This basically allows for more or less supply to meet the current level of demand. If you're at the debt ceiling, then basically it's not possible to mint some more DAI. You're at the ceiling for debt, then people cannot go in and deposit more collateral and mint some more DAI. We have to wait until some of the old debt is paid so this is all paid off. This is another mechanism for stability. There's also liquidation issues. When the position as I showed you goes under the collateralization ratio, there will be a liquidation and there's a liquidation penalty. That penalty is calculated as a percentage of the debt and is deducted from the collateral. Again, this is just one additional mechanism that we'll look at. This all makes sense but the collateral is still very risky. Even with a collateralization ratio of 1.5 or 2.0, it is possible that there could be a huge drop in the value of the collateral. We've seen this historically. In the crypto space, at the end of 2017, cryptos lost 80 percent of their value, which would challenge the collateralization ratio. What happens if there is a sharp drop in the crypto? Basically, there's just not enough collateral to pay back the debt. That's something that we need to worry about. Essentially, what the DAI system has done is to create a second layer of risk management and this has to do with protocol debt. There's going to be a buffer pool. That is going to be helpful in a situation where there's an extreme event and we go into a situation of under collateralization. That's kind of the second layer of risk management is buffer this pool. Ideally, there's enough funds in this buffer to actually cover the under-collateralization. There's actually more. There's a third level. The third level is, well, what happens if you run out of the buffer? You're undercollateralized and you still need to pay back the debt. The way that that happens is with the governance of the MakerDAO.

# overnance
Okay, now let's talk about the MakerDAO, governance. So, we've got a mechanism that we described that makes a lot of sense. You've got over collateralization. Is one of the forces that keeps the DAI close to the dollar. We've also got basically a stability fund. So, if there was a situation where we go under the collateralization. Then, we could actually use the stability fund to essentially bailout the protocol. But, it's also possible that we go beyond this. And the stability fund is actually exhausted. So, we need to talk about the governance. So, as I mentioned, the governance token is the MKR. And the token holders have the right to vote on protocol upgrades. And that might be supporting a new type of collateral. For example, when MakerDAO started. The only collateral was ether. Now, there's a range of different ERC20 tokens that are used as collateral. And the governance also can change parameters. So, it might be the collateralization ratio will change depending upon the volatility. So, that the governance is supposed to make decisions in the best interests of the platform. And, it is definitely within their interest to do the right thing for the platform. Because if they start doing things that are deemed unhealthy for the platform. Then somebody else will create a copy of this protocol with more favorable parameters. Okay, so they're definitely incented to do the right thing. So, let's kind of go through what that right thing is. So, Marie said that there was two levels of risk management. And MakerDAO. The first level is the over collateralization.
Play video starting at :2:33 and follow transcript2:33
The second level is the stability.
Play video starting at :2:37 and follow transcript2:37
But, what happens if something catastrophic happens. And you exhaust the first two and you need a third level. That third level is called global settlement.
Play video starting at :2:52 and follow transcript2:52
And what happens here? So, essentially got a situation where we need to pay back the debt. We don't have enough collateral and we don't have enough and the stability funds. We need to come up with some more funds.
Play video starting at :3:7 and follow transcript3:07
And the way that this is done is with the maker token.
Play video starting at :3:13 and follow transcript3:13
So, think of what's happening here is that maker will basically inflate. So, new maker tokens are minted. And those are used to pay back the debt.
Play video starting at :3:35 and follow transcript3:35
Okay, so this kind of fills the gap. So, you might think, well the maker holders, they could just pledge a certain percent of their tokens to actually bailout. But that would be really difficult to do. You can't really decentralized finance, force people to pay a tax like that. But effectively, the minting of the new token is doing the same thing. So, is deluding the value of maker for the existing holders. So, this is very analogous to, it's almost like a bankruptcy. Where you have to offer new equity to different equity holders, to get started again. And this is effectively what's happening here with the maker token. So, the maker token is diluted. And this basically is called the global settlement. So again, there's lots of interesting things that the maker community actually deals with. Indeed last week, I was invited to talk to the maker community. So, we did a Zoom and I talked about this learning experience. That we're actually going through. And the focus that I put on Maker. And, so, this is an active community of token holders. That are again strongly incented to do the right thing for the actual protocol. So, makers got value. So, the token is traded, has got considerable value. And, while it's not equity. It is possible in the future that there could be cash flows associated with this token. So, it definitely has some tangible value in the future. And that's why it's valuable. So, overall here, DAI is very attractive. Because you can purchase DAI, utilize it as a stable coin to move very quickly. For example, between different exchanges. So, this is not like you have to wait two days. To transfer some dollars from one exchange to another. So, this is something that lives on the ethereum blockchain. And can be deployed very quickly. So, it's also the case that you really don't need to know the underlying mechanics. Like you need to know for this course, right? Because you are raising your level of expertise considerably. But, just an average user, this is just a stable coin, it's like USDC. It's like Tether and maybe I should qualify Tether. Because we don't really know what the collateral is for Tether. At least we do know for USDC. But, this is a completely open protocol. Where you can have instantaneous audit of DAI. So, it is extremely transparent. And you don't need to be engaging in all of the mechanics. To use it just as a stable coin, as a Cryptocurrency stable coin. So, very attractive. So, it's also possible to earn a return by holding DAI. So, you hold dollars, put your dollars in the bank and you're lucky to get anything. But for DAI, you can earn the savings rate.
Play video starting at :7:39 and follow transcript7:39
Okay, so, we've talked about yield firming and stuff like that. Well, these protocols, if you deposit your DAI, you get a rate of return. And again the DAI is linked to the dollar. So, it's not really that much different than earning a rate of return on a dollar deposit at a bank. It is different of course, there are a different set of risks. That are involved for DAI than depositing money at a bank. But, this is quite possible to do. And more sophisticated users can can use this protocol for leverage. Looking at cross platform, liquidity. And it's very easy to buy or sell with this particular protocol. So, this looks very good. It's very exciting. It's one of the leaders in the space. But what about the downside? So, one downside that's pretty immediate. Is that the supply of DAI is constrained by the demand for each collateralized assets. Okay, so, if you think about the maximum amount of supply of DAI. Is going to be linked to the maximum amount of ether. That's available to be pledged. And the ERC20 tokens that are accepted within MakerDAO. So, that provides a cap on how far you can actually go. In terms of arbitrage, there's no clear arbitrage loop. So, for example, with USDC.
Play video starting at :9:41 and follow transcript9:41
I can get $1 dollar from Coinbase for 1USDC, okay. So, if I'm able to buy it cheaper somewhere, let's say for 99 cents. I can sell it for the dollar and make a profit. There's nothing like that within this particular structure. So, that is somewhat of a drawback but DAI track record speaks for itself. In terms of its stability is very impressive with respect to the competitor, centralist stable coins. So, at the end of each of these protocols. I'd like to go through the problems that they're solving. So, remember I said in the very first course. That is really crucial for a new idea to clearly solve a problem. And that problem needs to be a big problem or it's not that interesting. So, what I'll do, is kind of go through the traditional finance problems. And how MakerDAO actually solves some of these problems. So, I've got a chart here. Going through the five problems in the course like centralized control. So, this is basically interest rates are controlled by the Federal reserve. But the MakerDAO platform is decentralized. So, there's no central control for it. The holders of the maker token are the ones that actually decide. So, limited access is the second problem of TradeFi, traditional finance. And obtaining alone is often difficult to actually do. So, again, it could be a mortgage. Where it's very costly to actually go through and get a mortgage. It's very costly to do a home equity loan. It's very costly to do a refi of your mortgage. Whereas with MakerDAO, basically this is open to anyone. Actually pledge some collateral and get a loan. It doesn't matter who you are and you can pledge with ether or ERC20 token. And I'm sure in the future, the number of ERC tokens that are pleasurable. Will grow very considerably.
Play video starting at :12:22 and follow transcript12:22
So, number three is inefficiency. And I've actually already mentioned this. That it is incredibly inefficient to get a loan. And, I mentioned a little earlier about a personal experience in refinancing my mortgage. And, I refinanced with the same bank that holds the original mortgage. But that same bank insisted on a title search. To make sure of the ownership of the house. Which to me, didn't make any sense because they've got the title, right. So, I pledged the house as my collateral. So, it's just an unnecessary cost. The employee of lawyers to do something that doesn't make any sense. It is pure inefficiency. So, this is for MarkerDAO, we've got instant liquidity. I say at the push of button and this is like within a minute. You've got this liquidity. Like there's no process of approval or anything like that. You get your liquidity in terms of the DAI. And then you can use that for whatever you want. So, the fourth is lack of interoperability and it's difficult, of course. You can't trustlessly used things like US dollar collateralized tokens. There is some level of trust that you need for USDC. That the collateral is actually there. And tether again remarkably is a very important token. In terms of the crypto space, but it is not audited.
Play video starting at :14:19 and follow transcript14:19
It's not transparent. And of course that's the last issue here, opacity. And it's not just the lack of transparency for something like tether. But, think of the lack of transparency for our commercial banks. We were blindsided in the global financial crisis. People didn't know the risk that these banks were taken to leverage. That they were taken, was so extreme. I have no idea. And right now, we still don't have an idea. We've got our regulators. But as I said in the first course, the regulators are often one step behind. And have to react to a problem, rather than proactively trying to eliminate the problem before it occurs.

# Compound
So the second protocol that will talk about in this section on credit and lending is compound and compound is very important apart of the DeFi ecosystem. So what is a compound? So this is a lending market and it offers many different ERC-20 assets for borrowing and lending.
Play video starting at ::34 and follow transcript0:34
And interestingly and we'll go through the mechanics of this. All of the tokens in a single market are pooled together, so every lender earns the same variable interest rate and every borrower pays the same variable rate. Okay, so that's different than what we talked about would DAI. So, there's obviously many similarities. And given that we're using cryptos, we need to think about overcollateralization again. Okay, so within this space there's no credit rating. So people are not really identified pseudonymous, so you don't really know who they are, they don't have a credit rating and there's no way to send the the collector if somebody is undercollateralized. Okay, so this idea of rating is irrelevant within the space and this is the reason that we have to have overcollateralized lending. So, this is again much different than the usual situation for everyday lending but it is analogous as I pointed out earlier to a collateralized debt position like a mortgage. So, if the borrower falls below the collateralization ratio, the position is liquidated just like we saw with the MakerDAO. And just like MakerDAO, the liquidation can be done with the keeper and the keeper is incented to actually check. They check for situations where there's a liquidation opportunity, so where the collateralization ratio is pierced and their incentive is a bonus to actually do that.
Play video starting at :2:41 and follow transcript2:41
So let's go through collateralization ratios and factors. So we've talked about this a little bit with MakerDAO, we'll go into much more detail. It's going to be a little more complex because we have multiple cryptos to deal with. So it turns out that every crypto within the compound platform has got some collateralization factor. And these factors range from zero to 90. So a factor of zero means that the asset cannot be used as collateral. And as that factor gets higher and higher, the crypto is deemed less risky. So the safest cryptos would have the highest factors. So, the required collateralization ratio is basically 100 divided by the collateral factor. Collateralization ratio is 100 divided by the factor. And we'll again, go through some examples to show you how this actually works. So, again, the most volatile assets have the lowest collateralization factors. Okay, so, if for example, you've got a collateralization factor of 50, then the ratio is going to be 100 divided by 50 is two. And we actually talked about collateralization ratio of two in the context of MakerDAO.
Play video starting at :4:34 and follow transcript4:34
So, this is a protocol where you can have multiple different types of collateral. So, the way that we'll actually calculate the collateralization ratio is to look at a weighted average of these factors. And it makes intuitive sense in terms of calculating across different cryptos which might be of much different risk. So for example, USDC would be very safe with a very high collateralization factor and a very low collateralization ratio. Whereas something like Ether we know that's much more volatile. So their factor will be lower and the ratio higher. Okay, so we can actually think of this collateralization ratio like a reserve multiplier and this is lingo from traditional centralized commercial banking finance. Okay, so essentially a collateralization ratio is very similar to a reserve multiplier. In traditional banking, of course in traditional banking the banks need to take a certain amount of their deposits and hold that at the Federal Reserve or whatever central bank on reserve. So there's a limit in terms of how much money can be created in the system.
Play video starting at :6:17 and follow transcript6:17
Okay, so this is important in terms of how this system actually works. So let's go through some examples. The first one is an investor deposits, 100 DAI and DAI, it's got a very high collateral factor which is 90 reflecting that it is very low risk. So, it's pegged to the dollar. It's volatility is small. So the factor is 90. So, to get the collateralization ratio, that's really easy, we just take 100 divided by 90. And that comes up with the ratio of 111%. So, this is basically saying that if the DAI is worth $1, then if you deposit 100 DAI, then you can borrow up to 90 dollars worth of any other asset in compound.
Play video starting at :7:28 and follow transcript7:28
Okay, so again, if you deposit a safe asset then you can actually borrow more as a result because the collateral factor is so high.
Play video starting at :7:44 and follow transcript7:44
So, let's again go through an example here. Suppose the user burrows the maximum and the price of the borrowed asset increases, then we need to be cognizant of all of the components of what's actually happening. So, we don't want to be subject to liquidation.
Play video starting at :8:17 and follow transcript8:17
So, you would probably never actually go and borrow at the collateralization factor are right at the ratio and it's very similar. So what we talked about with MakerDAO it's too risky. A small fluctuation could cause the liquidation. Okay, so so let's actually look at a different situation where it's not just 100 DAI that are deposited but an additional deposit of collateral is put in with a two Ether. So Ether in this particular example has got a lower collateral factor and it's going to be 60 which reflects the risk of either versus DAI. And let's assume the price of of Ether is $200. Okay, so now we've got a total dollar amount of 500. So we've got $400 worth of Ether and $100 worth of DAI.
Play video starting at :9:31 and follow transcript9:31
Okay, so in terms of the weighted average here, 80% is in Ether and 20% is in DAI. So we can easily calculate the weighted average of the collateralization. And so basically the collateral factor is just 0.8 times 60 plus 0.2 times 90. That's the factor. And then to get the collateralization ratio, we just take 100 and divide by the factor. And when you do that you get a 151% approximately.
Play video starting at :10:15 and follow transcript10:15
Okay, so this is an example of having multiple things that you're using for a collateral. And I've got a graphic that shows this, we've got the Ethereum and the value of that is 400, the DAI, we've got $100 worth of that. And then I'm actually showing on this graphic the borrow liquidity. So given, so if this was just Ether, so if it was just $400 worth of Ether, then the borrow capacity is $240. Or if this was just DAI, then the borrow capacity is 90. So when you put that together, the borrow liquidity at the maximum and I'm not suggesting you would do this at the maximum, but at the maximum is 330. And again, if you do this, you look at the total collateral divide that by the borrow liquidity of 330, you get the collateralization ratio, which is one 151%. So this is just another way of working out what the collateralization ratio actually is, and a very intuitive way to do it.

# Supply and borrow rates
Okay, so the next thing in compound that we need to understand is how supply and borrow rates are actually calculated. So again I've got a number of examples of the mechanics and it's important to go through these details to understand what's happening. So again if you're supplying capital you should get a rate of return for that and if you're borrowing you need to pay something. Okay, so these rates are compounded every 15 seconds 15 to 18 seconds on the Ethereum Blockchain. So it's interesting that this produces something that we talk about in finance a lot but it's mainly theoretical, a continuous interest rate. So this is in traditional banking, maybe you've got a daily compounded. All right, well this is one step beyond that, we're compounding every 15-18 seconds. So some terminology that we'll talk about. And one thing is the utilization, so the utilization has to do with the amount of borrowing relative to the amount of supply.
Play video starting at :1:27 and follow transcript1:27
Okay, so you can never have this situation where you're borrowing more than the supply. So the amount of borrowing is always less than the supply.
Play video starting at :1:39 and follow transcript1:39
So the utilization rate, so that is literally the amount borrowed divided by the supply, that is going to be a parameter that's going to play an important role in this protocol and there are other parameters that are set by the compound governance. So compound again is a decentralized protocol like maker, it has a governance structure that is decentralized.
Play video starting at :2:20 and follow transcript2:20
Okay, so let's go through some formulas here. And the first thing will establish is the the borrow up formula. So the borrow formula is going to be an increasing function and the y intercept is going to be the base rate.
Play video starting at :2:42 and follow transcript2:42
And I will make assumptions in terms of what that actually looks like. And that is the rate where there's zero borrowing a demand and then there will be a slope and that slope represents the rate of change in the rights. So the slope and the intercept these can be different for any ERC- 20 asset that supported in this platform.
Play video starting at :3:17 and follow transcript3:17
Okay, so let's kind of go through and talk about some examples and some generalizations it's also possible that the formula is more complex than a linear formula. So it might be that there's a kink in the formula. So think of it as at some point the slope becomes much steeper. And we'll go through an example of this particular situation, but the idea is that once you get close to capacity, you want to start discouraging borrowing. And one way to do that is to jack up the rate faster than a linear right? So again, we will go through an example like that. So this is very mechanical and very straightforward. So on the other side you've got the suppliers of liquidity. So there's a supplier interest rate. So that rate is going to be the borrower, right? Times the utilization ratio, which kind of makes sense. And we will go through lots of examples here that think of it as suppose nobody is doing any borrowing, there's no revenue, so there's nothing to pay out in terms of the supply interest rate. Or if 50 of the money is borrowed, then you collect the interest on that and then you need to distribute it amongst all of the suppliers. Okay, and that's where the utilization ratio actually comes in to play.
Play video starting at :5:16 and follow transcript5:16
There's also something important called a reserve factor. So this is and amount of the revenue that's coming from the people borrowing that set aside as a reserve. So the suppliers actually don't get that. And this reserve pool is important because there could be a situation like we talked about with Mikado where there's a default. So being a situation where we've got under collateralization and this reserve pool is actually used to cover that.
Play video starting at :5:56 and follow transcript5:56
And there is also various mechanisms that are designed to mitigate the risk and maintain the confidence in this particular protocol. So let's go through some examples. So let's say in the die market, there's 100 million that supplied and 50 million is borrowed. Okay, so people have put in as a supply 100 million die and within the compound market 50 million is borrowed.
Play video starting at :6:41 and follow transcript6:41
And now suppose the base rate is 1% and the slope is 10% or 0.1 so 50 million is borrowed.
Play video starting at :6:53 and follow transcript6:53
So the utilization is 50%.
Play video starting at :6:57 and follow transcript6:57
So the formula would be the 0.5 which is the 50% times 0.1 plus the base rate which is 0.01 In that equals 0.06 or 6%.
Play video starting at :7:14 and follow transcript7:14
Okay so if we ignore the reserve factor then what would be paid out to the suppliers would be the 6% times 0.5.
Play video starting at :7:34 and follow transcript7:34
So 3% would be paid out to the suppliers.
Play video starting at :7:39 and follow transcript7:39
So again notice that the suppliers are getting less so the borrowers are paying more like I know it's a bit of a stretch for an analogy. But in a banking situation the rate that you get for supplying your capital in a savings account or certificate of deposit is far less than what the borrowers are actually paying. So it's a similar idea.
Play video starting at :8:11 and follow transcript8:11
Okay so this is also important.
Play video starting at :8:16 and follow transcript8:16
The borrower rate is not a marginal rate, it's the rate for all borrowers. So this rate can be changing through time. So for example suppose we think we know that there's 50 million that's borrowed but let's think of it in two chunks. Suppose somebody comes in and borrows 25 and then the next person comes in and borrows 25. So if you think about that first chunk. Well let's calculate the rate. Well that's 25 million. So 25 times 0.1 and then we've got the base rate of 1% so we get 3.5%.
Play video starting at :9:7 and follow transcript9:07
So if that was the entire amount of borrowing then the borrower rate would be 3.5%.
Play video starting at :9:19 and follow transcript9:19
So then somebody else comes in and borrows another 25.
Play video starting at :9:25 and follow transcript9:25
So we've actually already gone through that calculation. So the rate will increase to 6%. And the key thing here is that rate applies to all borrowers. So if this is done in two stages you would think the first borrowers getting a really good rate but that rate increases. So again there's not a marginal rate it applies to everyone. So let's kind of go through this in an example and now we'll actually talk about the reserve factor. So let's say we've got a reserve factor to set to 10. So that means 10% of the borrow interest is going to be diverted into a dive reserve pool. So that will actually lower the supply interest rate. It doesn't affect the borrower rate it reflects reflects the supply rate. So it'll be now 2.7. So think of this as the .5 which is the utilization ratio times that 6% and then 1minus 0.11 is going to equal 0.027 or 2.7%. And again in this graphic can kind of see what's going on. We gotta borrow rate of 6%. So the total revenue that's coming in, let's say over a year is going to be three million. So that's 6% times the 50 that's actually utilized the 50 million that's utilized. We need to set aside 10% of that for the reserve pool and that will be 0.3 or 300,000 will be set aside and then what's left to distribute to the suppliers is the three million minus what we're holding in reserve the 300,000. So what's left for suppliers is 2.7.
Play video starting at :11:33 and follow transcript11:33
Okay, so you can see that this reduces the supply rate, but now we're actually making this more realistic in terms of what it actually looks like in practice with a reserve pool.
Play video starting at :11:51 and follow transcript11:51
So another way to think about this and it's important to understand this is that that this 6% rate like in the diagram just generates not six million in revenue. That would only be six million in revenue if there was 100% utilization only 50 million is being actually used. So it's Just generating three million. And that's why the supply rate is less than the borrower, right? And then it's reduced further because some money is set aside the cover situation where there's some under collateral ization.
Play video starting at :12:41 and follow transcript12:41
So it is different, but it is fairly mechanical and intuitive. So I mentioned the kink and let's talk about that a little bit. So again, we've got 100 million DAI that supplied. And now let's say that 90 million DAI is borrowed. So that's a 90 utilization ratio. And now suppose that our formula has got a kink and the kink is that 80% utilization? So before the kink we've got the identical situation that we had previously, we've got a slope of 10% or 0.1.
Play video starting at :13:25 and follow transcript13:25
But after that 80% utilization, the slope gets a lot steeper. So now the slope goes to 40 or 0.4. So the bar rate is going to be much higher if that threshold is actually exceeded and in this example it actually is exceeded. So again let's kind of go through the mechanics the base rate is 1%. So the borrower rate is going to be the 1% for the base rate and then a combination of the pre kink and the post canker. So we've got 0.8 utilization times that slope of 10% or 0.1 and then we're actually not at 0.8 where at 0.9. So we've exceeded the 0.8 by 10%. So we add in another term here. So it's 0.1 times the new slope which is much steeper of 0.4 and then you see what happens to the borrower, right? The borrower rate is now 13%.
Play video starting at :14:45 and follow transcript14:45
So again, we could do a quick calculation, the supply rate and the supply rate in this particular situation and again just to simplify things will ignore the reserve factor 0.9 which is the utilization times the actual borrow interest rate which is 0.13 equals 11.7%.
Play video starting at :15:13 and follow transcript15:13
Okay so this is how this actually works. So let's talk about the advantages of compound. So like make a doubt this is a way to unlock value in an asset without actually selling it. So again it's like a home equity loan where you pledge your house and you get some cash. It's also very easy to engineer livered long or short positions with this protocol.
Play video starting at :15:51 and follow transcript15:51
Okay so this is quite easy to do. We did an example and when we talked about Negredo about using leverage where you would draw you borrow and then use that borrowing to buy more of the base asset and effectively take a leopard position. So again let me go through an example of how this could work. So suppose you are actually in this case bearish. So the example I gave a maker dow was you thought the price was going to go up. Well suppose you think that the price is going to go down.
Play video starting at :16:34 and follow transcript16:34
So you're bearish unless say the price of either so you deposit a stable coin in the compound and let's say that's us dc or die and then you borrow teeth and then you sell it and you sell it for the stable coin. And basically if the price of each falls, then you can use your stable coin to buy the cheap either and then you pay back your debt and you made a profit.
Play video starting at :17:17 and follow transcript17:17
Okay so think of this as if you did this, you deposit enough stable coin you get one teeth and I suppose it's worth $200. You sell it, you get the $200 and then the price drops by 50%.
Play video starting at :17:34 and follow transcript17:34
Well you go into the market, you buy for $100 and then repay the loan and there'll be some interest I'm abstracting from. But you can see that this would leave approximately $100 in profit. So short position very straightforward to deal with in this particular protocol. So leverage, which we talked a little bit about with a mega dow same sort of thing that again you're let's say bearish on the price of ether. You deposit a stable coin, you borrow ETH you sell the ETH for the stable coin, you deposit the extra eat are the extra stable coin and borrow more teeth. And then you sell that again for stable coin and deposit even more of the stable coin. And again what you're doing is getting a lever position and in this case if the price of ETH actually does fall the prophet would be much greater than the previous example. So this is an example of how to do leverage and how to use this protocol for taking bullish or bearish positions.

# cTokens
Okay let's continue our exploration of compound. And I want now to talk about and equity token. And we talked about equity tokens in the actually the previous course and this is going to be a tangible example and we'll talk about C tokens so c lower case and then token. So let's kind of go through and figure out what's actually going on here. So basically compound when you deposit tokens as a supplier this is a service and you expect a rate of return. But it's kind of complicated to keep track in terms of all of the depositors, the different tokens and things like that. So we want to do this in a way that's algorithmic and really straightforward and the logical thing to do is to tokenize the users share of the pool. Okay so you deposit something and then you actually get a token that represents your participation in that pool. And compound does this with their C token. And this is a very important innovation in terms of this protocol and indeed it's been copied by many other protocols. So a simple way of keeping track is to actually create another ERC token. So think of somebody depositing some ERC 20 token and then getting another token that actually represents their share of that pool. So it is a valuable asset obviously that token because it represents a share of the deposits. So we'll go through how this actually happens but when you're a new supplier then new c Tokens are created.
Play video starting at :2:29 and follow transcript2:29
And for example if this is di this would be like a C die.
Play video starting at :2:37 and follow transcript2:37
And when you withdraw this is basically a situation where the token is burned. So you no longer have, let's say 10% of the pool, okay. So it's a very natural way to keep track in an algorithmic way.
Play video starting at :2:58 and follow transcript2:58
So it turns out that because these c tokens represent a share of a liquidity pool, they're valuable.
Play video starting at :3:10 and follow transcript3:10
So they're literally collateralized by the pool.
Play video starting at :3:16 and follow transcript3:16
So these tokens have like additional use so they could be used for collateral themselves, okay. And kind of see bourbon going here that this creates a multiplier type of effect. And it also allows compounds token these c tokens to be used in other defy protocol. So it's possible for example if somebody wants to use less a eth for collateral, they can also use ce three which represents a token that's linked to a vault that's got some eth in it. Okay, so very nice idea. And these tokens can be traded, right? So you can have ce eth and eth that are being traded. DAI and C DAI. Okay, so it opens up many possibilities here. So let's go through a few examples the best way to see what's actually going on. So in this case here I've got 2000 DAI and the compound DAI market and a total of 500 c DAI which represents the ownership in the market. So the ratio of cd to DAI doesn't really matter that much as I'm going to show you. So on the left we see that there are 2000 died that's the total supply. The one C DAI equals four DAI.
Play video starting at :5:6 and follow transcript5:06
And in this particular example we've got to depositors and one has 375. The other 125 and this is basically 500. So in this particular situation you've got 2000 DAI. There are two traders in this particular market and their shares are 75 and 25%.
Play video starting at :5:44 and follow transcript5:44
Okay so that is kind of where we start. So let's say that another trader comes in and deposits 1000. So previously we had 2000 DAI remember we had 2000 DAI and trader a represented 75% of that and try to be 25%. So now somebody else comes in and we raised the total supply from 2000 to 3000 DAI. So again one C DAI equals four on four DAI. So the new there will be some more c DAI created. So we started with 500 c DAI. So an additional 2 50 are created and you can see that traders C has 250 and 200 and 50 of 750 is 33%. And again this makes sense. So this is keeping track of the accounting here for the ownership of the supply.
Play video starting at :7: and follow transcript7:00
Okay so I think if we started with 2000 DAI, somebody else comes in trader c. And increases the supply to 3000. Well the 1000 to 3000 that's 33%. And that's exactly what's happening here. So within the CDAI the trader has 33%. So what's the next step here?
Play video starting at :7:30 and follow transcript7:30
So suppose that there's interest that's accruing.
Play video starting at :7:37 and follow transcript7:37
So within the supply of 3000 DAI suppose there's interest occurring at a rate of 10%. And let's go through a year. And at the end of the year the supply pool will be worth not 3000 DAI but 3300 DAI.
Play video starting at :8:1 and follow transcript8:01
So what does that mean for the c token holders?
Play video starting at :8:6 and follow transcript8:06
Well the number of c tokens has not Increased. There's 750 c tokens. But the value of the supply has increased.
Play video starting at :8:20 and follow transcript8:20
Okay it's increased by 10%. So the new exchange rate is not one C DAI. Equals 4.4 DAI but once he di equals four 0.4 DAI.
Play video starting at :8:34 and follow transcript8:34
And if you look at the shares so the shares haven't changed. So you can see that for example trader C. Who has 33 of the pool.
Play video starting at :8:49 and follow transcript8:49
Well what is there? 33% worth? Well 33% of 3300 DAI is 1100. So again they put in 1000 DAI. And now after the 10% is paid they get both that supply and the interest and 10% interest is it comes to 1100, okay. So this is a very elegant mechanism to keep track of basically the shares and the value within the pool. So again the C DAI that you get after supplying the DAI. The C DAI can be deployed somewhere else. So it's no use just sitting on the C DAI when you could potentially deploy it to another protocol and potentially use that to earn an extra rate of return. Or you could use it as collateral for some other protocol. And we'll talk about dy dx within this course also or swap that there are many different possibilities here to actually use this.

# Compound overnance

Okay, let's talk about governance and we've talked about this briefly but within compound there's a decentralized governments mechanism, there's many different parameters that the governance controls. So the collateral factor that we talked about in detail, the reserve factor, the base rate, the slope the kink all of these parameters can be fine tuned by the governance. Okay, so again this is a decentralized governance and the governance has the incentive to do things that are the best things for the actual protocol. If they don't do that, then they will lose out to the competition. So it's really important to realize that the governance can't steal funds r block users so you can't blacklist anybody, this is open to everybody and the parameters that they can control are limited. So for example a parameter, there's no parameter that says the divert the funds to the governance because people would never use compound if that was the case. Now, it's interesting that early on and compound the governance was controlled by the developers and this again is kind of common and many tech startups that the debs have a lot of control over the protocol because they anticipate that there could be some issues that need a fine tuning. So this was definitely the case but it was important that the compound realized that this had to be a short term mechanism so all along they planned to go completely decentralized and it is completely decentralized today. So again it's important within the space of deep I to avoid centralization, which could lead to arbitrary moves the blocking of certain addresses and things like that. So compound implemented their new decentralized governance in May of 2020 with the cob token and implemented it in June of 2020, the so called seventh governance proposal, I mentioned this detail because it is important, it is a model of how decentralization actually happens. So what's very interesting is the comp token was distributed to the loyal users of the actual platform. So those that were supplying those that were borrowing got basically an airdrop of comp token, and the amount that they got was basically based upon how much volume they were actually doing. So the early users of this platform got a bonus in terms of the comp, so comp is very similar to make her the MK our token, both of them are governance tokens. So this is interesting, it's analogous to a tech company and kind of traditional economics giving away its own stock to the early users of the company's goods or services, so very easily done within this particular protocol. It would be difficult to do this in a regular economic system but very easy to do within decentralized finance. So that's not the end of the story. So the comp token continues to be used to incentivize people to use the platform. So this is distributed to both suppliers and borrowers. And for the borrowers it acts as a subsidization of the loan. So the supplier is getting a supply interest rate and they will also get a bonus in the comp token. So that will just increase the rate of return that they actually get. Indeed some of these claims. Very high rates of return for depositing in defy protocols. Well, it's not just the savings order deposit rate that you're getting. You also have to factor in the value of the governance token that you're also receiving. And it's also the case that you've got borrowers that the rate on borrowing is considerably reduced as a result of this subsidization. So it's interesting this was done almost instantly the comp the governance token had a market cap of over $2 billion. Okay, so this meant we had this very strange situation that some people that were borrowing the amount of comp that they were getting as a bonus for actually participating in the protocol was sometimes greater then the cost of borrowing. So think about that. So again, this is hard to think about in a regular system where you borrow money from the bank and you have to pay the bank. Let's say 10%, but then the bank pays you a bonus of 15%. So effectively the bank is paying you 5% at the bar, okay. So again this is something that really incentivize people to use the actual platform. So this is interesting this protocol, it exists within the Ethereum Blockchain. This is not something that can be turned off, it might be that a better platform arises, it might be the compound actually offers something that's better. But this is a very important mechanism within this space and there's so many possibilities here. I talk about, yeah, in the previous course, I talked about a fair lottery and this is exactly possibility using A protocol like this. So the usual a lottery 50% at least is taken for overhead and for other purposes you can easily create something very powerful within the system. So let's finish off and to the usual job that we do, looking at what compound actually does to solve problems. So again, centralized control, this is not decentralize. It is something that is completely decentralized. The rates that are paid. Both the supplier and borrowers are algorithmically determined and the parameters are controlled by the governance token, the comp limited access. Again, this is a common thing that you need to do credit checks and some people are blocked. This is open to anybody, inefficiency. Well, we've got rates and traditional finance that are way too high for borrowing and savings rates, you've heard me say so many times are way too low. And this actually pools everything together and determines the optimal interest payment. And that means the suppliers get a higher rate than traditional finance and borrowers pay less. I lock up interoperability. Well, these positions within compound are tokenized in themselves with the c tokens. The the share of the collateral is freely traded and can be used in other protocols. So this is exactly what we're looking for in terms of interoperability. And just think about how impossible that is in traditional finance and opacity. Well, everything in this protocol is transparent so we know anybody can see the collateralization ratios, anybody can see the parameters that are actually being used. This is completely transparent and a very important idea within the defi ecosystem.

# Aave
The third protocol that we'll take a look at within credit and lending is called Aave. I've got a very nice example of a refinancing in this module so we'll be able to see the mechanics of how something like this actually works. Aave launched in 2017 so it's been around a while. I know that doesn't seem a long time but this is actually a long time within a decentralized finance. It is also a leading protocol and it's similar to Compound. At this point in time, at least there's more tokens to supply and borrow within Aave. Aave is also got something that's interesting in that the rates for borrowing and supplier are more predictable. We'll talk about that to some degree. For example, we already saw in Compound that it is possible as the utilization ratio increases, so that could greatly increase the rate of interest cost. Aave offers something a little different in terms of this. Think of this as two markets. The first is more conventional ERC-20 tokens, very similar to Compound. We've got the main assets, Ether, USDC, the stablecoin that's guaranteed by Coinbase and DAI, which we've talked about in this course in considerable detail. There's also another market that's specific to the Uniswap UNI token. Uniswap is next. The next module is on decentralized exchange and we will go through a lot of detail in terms of what Uniswap actually does. The LP token. That's LP for liquidity provider. This will be something that can be used in terms of the Aave protocol and other DeFi protocols. It's another way to generate returns. Aave also offers flash loans. The fee for the loan is nine basis points, so that's 0.09 of a percent. That's pretty cheap. Remember, we talked about these loans that they've got zero duration and there's no obvious counter-party risk. Nine basis points, it seems cheap. It is cheap. But I predict that these rates will go down. Indeed, by the time you're actually viewing this, the rate might be lower, and we'll explore the reasons why. Where does this fee go? The fee goes to an asset pool and provides additional returns to the suppliers. It's not like dividend it out. This just goes in as an extra rate of return. The flash loan is going to be very useful in terms of giving users the ability to access capital very quickly to do what they have to do. That might be an arbitrage trade or it might be a refinancing. Let's go through some examples. Suppose the price of ETH is 200 DAI and then a user supplies 100 ETH in Compound and borrows 10,000 DAI. I know we're talking about Aave, but we're going to start this example with Compound. There's a loan right now for 10,000, and it's possible they can lever up and purchase an additional 50 DAI and then they use that also to supply in Compound. Now, suppose the borrow interest rate in DAI on Compound is 15 percent but in Aave, suppose the borrower rate is only five percent. You've already done the loan with compound, and you're paying 15 percent. There's a cheaper possibility at five percent. Our goal here will be to refinance the borrowing, to take advantage of the lower rate offered by Aave. This is very analogous to refinancing a mortgage. The rate goes down, you want to refinance. But in traditional finance, as I've already described, that takes a long time and it's awkward to do. Let's go through some of the mechanics of a refinance. One possibility is just to manually unwind each trade on compound, and then do the trades again on Aave, and reconstruct the levered up position. That's possibility to do. That's in two steps. It will take two transactions, at least to do that. Of course, we need to deal with the transaction fees that are associated with that. The other possibility, is to use a flash loan, and to do this all together in one step. Let's actually go through the mechanics here. I've got a diagram for this, but let me just tell you the basic idea what's going to happen. What we're going to do, is going to take a flash loan from Aave for 10,000 DAI. We're going to use that loan to pay down all the debt in compound. We will withdraw the 250 ETH from compound. We will resupply to Aave, and at a five percent annual percentage rate against that collateral to repay the flash loan. We borrow from Aave, and then we're going to repay the flash loan. The latter approach basically, skips a lot of exchanging, and does this in one step. Let's take a look in a little more detail with this particular diagram. Before, we've got a 150 ETH as collateral, we've got a loan of 10,000 and an interest rate on compound of 15 percent. What are we going to do? The first thing we're going to do at the bottom, number 1, is initiate a flash loan on Aave, and that will be 10,000 DAI. Step number 2, we will repay with the flash loan, the loan that we've got at compound. When we do that, we reclaim our collateral. Step number 3, we reclaim the 150 ETH. Number 4, we will deposit the 150 ETH in Aave, and then we will use that as collateral, to borrow 10.000 DAI, against the ETH. Then the final step, is to close the flash loan at 10,000. This is extremely interesting, because this is a single transaction, and what we have done, the transactions got many steps. It shows the possibility of going from one DeFi level, to another. We're using both compound, and Aave. Essentially, we're getting a flash loan with no collateral, with no credit check, and the loan has got zero duration, because it actually happens to be taken out and paid back in the same transaction. Again, there's a small fee that's associated with this that I'm abstracting from. But this is a way to refinance, to get a lower rate, and it is very elegant. Later in the course, actually in the fourth course, we will talk about a much more elaborate transaction that goes not just between compound and Aave, but has got 63 different steps to it. But this is a simple example, of what actually is possible within this protocol. This is our introduction to the mechanics of a flash loan.

# Stable loans and credit deleation
The second thing I'd like to talk about with Aave is this idea of stable loans and credit delegation. The first thing, let's be careful. Aave offer something that is more stable than less a compound but it isn't fixed. You can think of a fixed rate loan that you might get for example, a mortgage might be a fixed rate. You could also have the variable rate mortgage. But we're not talking about fixed rates, we're talking about stable rates. The idea is they're relatively stable, so the word choice is important. This is not a fixed rate.
Play video starting at ::50 and follow transcript0:50
Basically, we can imagine a situation where the borrower has the option to switch between a variable rate and the current stable rate.
Play video starting at :1:5 and follow transcript1:05
The supply rate in contrast is not stable. It is always variable.
Play video starting at :1:17 and follow transcript1:17
It's really impossible to imagine a model where the supply rate is a fixed rate. The supplier obviously will earn the revenue that comes in from the stable and variable borrowed interest rates. Of course, there could be fees that are deducted from that and other things. But the basic idea is the same as we've seen before. Again, the stable rate is not a fixed rate. There is adjustment and extreme situations. If there's liquidity crunch then there will be an adjustment in the rate. But the idea is that it's just a little more stable than something that in other protocols you would experience. There is another idea in Aave and this has to do with credit delegation. The idea here is that users can allocate collateral to potential borrowers who could use it to borrow an asset. Everything we've done so far, you're actually providing the collateral. For instance, in traditional finance I've got a house, I pledged the house and I take a home equity loan out, so I'm pledging that collateral. There's a different type of loan in traditional finance where you don't necessarily pledge that collateral, a line of credit or something like that. Well, everything that we've done in decentralized finance has to do with fully collateralized or over collateralized borrowing. The idea in Aave is that we can retain the idea of over-collateralization but enable a possibility where somebody effectively provides the collateral for the uncollateralized borrower. Maybe this is the case that you know somebody and there is an element of trust here. This happens outside of the Ethereum blockchain but it is a way potentially to earn some extra funding. You can imagine that a delegator because they are basically pledging this collateral for somebody to borrow, there is some risk, of course, that there could be a default and they are not paid. But it's important to realize that, that default doesn't impact the protocol itself because the protocol is still going to be over-collateralized. Essentially something is happening outside with some level of trust that enables those that want to delegate their credit to earn an extra rate of return. This is a very interesting idea and one thing that has been lacking in the DeFi space is this idea of having people borrow without having the collateral. The flash loan is an exception here because it happens all within one transaction. It has got zero duration. What we're talking about here is having people being able to borrow within DeFi that don't have the actual collateral. This delegation is a way for this to actually happen. Overall Aave it's pioneered flash loans and this provides extra returns to their liquidity suppliers. It also attracts a lot of business to Aave for those that are doing arbitrage. We talked about a simple arbitrage where you could reduce the loan rate from 15 percent to five percent in our example but there could be other types of arbitrage that are available out there and flash loans are extremely useful in capitalizing upon that type of arbitrage. Aave also offers relatively stable loans in terms of the rate and this idea of delegation. A lot of stuff within this leading protocol. Let's look at the traditional problems and what Aave is doing here. On centralized control, we've got rates that are algorithmically set but had the possibility of being relatively stable. Limited access, now we've got the flash loans which are the ultimate democracy in finance where anybody can take one of these loans for arbitrary amount as long as it's paid back within the same transaction. Inefficiency again, very similar to these other mechanisms where there's maker or compound that we're algorithmically pooling the assets and optimizing the interest rates. By that it means that the suppliers are getting a reasonable rate of return and the borrowers are paying a reasonable borrowing rate, much different than centralized finance. Interoperability, a problem obviously in centralized finance. I showed you an example with the flash loan where we just seamlessly within one transaction went from compound to Aave. These are interoperable and of course, transparency. Everything is open, so anybody can see what is happening. The parameters are visible, the balances are visible, the collateral is visible. All of the steps. The flash loan that I showed you, you can literally click on "Etherscan" and you can see all of the steps. It's very clear. This is a very transparent mechanism as is all of decentralized finance.